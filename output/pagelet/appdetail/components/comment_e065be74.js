define("pagelet/appdetail/components/comment.jsx",function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var l=e("react"),i=n(l),s=e("pagelet/widget/components/rank.jsx"),r=n(s),u=e("pagelet/widget/components/loading.jsx"),c=n(u),d=e("pagelet/appdetail/action/action"),o=n(d),m=e("pagelet/appdetail/store/store"),f=n(m),h=e("constants"),p=i["default"].createClass({displayName:"Comment",getInitialState:function(){var e=this.props.query,t=this.props.filter||{},a=t.score||[];if(a=a.map(function(e){return e.value}),a=a.join(","),t.datetime&&t.datetime.year){var n=new Date(t.datetime.year,t.datetime.month-1,t.datetime.day);t.datetime.value=n.format("yyyy-MM-dd"),t.datetime.name=n.format("yyyy-MM-dd")}return{loading:!0,id:e.id,country:t.country?t.country.value:h.countryCode.CHINA,duraTime:t.datetime,device:t.device?t.device.value:h.deviceType.IPHONE,bIndex:1,count:50,score:a,list:[]}},componentDidMount:function(){this.fetchList(),this.unSubscribe=f["default"].listen(this.onStateChange.bind(this))},fetchList:function(){o["default"].commentDetail({id:this.state.id,duraTime:this.state.duraTime.value,country:this.state.country,device:this.state.device,bIndex:this.state.bIndex,count:this.state.count,score:this.state.score})},componentWillUnmount:function(){this.unSubscribe()},onStateChange:function(e){e.list&&(e.list=this.state.list.concat(e.list)),this.setState(e)},loadMore:function(){this.setState({bIndex:++this.state.bIndex})},render:function(){var e=this.state.list,t=(this.state,this.props.filter||{}),a=t.score||[],n=a.map(function(e){return e.name});return n=n.join(","),i["default"].createElement("div",{className:"comment"},i["default"].createElement("h5",{className:"title"},i["default"].createElement("p",{className:"fr f-txt f10"},n&&5==a.length?"所有评级":n," ",this.state.duraTime.name),i["default"].createElement("i",null),"评论详情"),e.length?i["default"].createElement("table",{className:"border"},i["default"].createElement("tr",null,i["default"].createElement("th",null,"评论内容")),e.map(function(e){return i["default"].createElement("tr",null,i["default"].createElement("td",null,i["default"].createElement("p",null,e.content),i["default"].createElement("div",{className:"c999 f10 mt6"},i["default"].createElement("i",{className:"mr6 t-vt"},e.authorName),i["default"].createElement("i",{className:"mr6 t-vt"},e.versionName),i["default"].createElement(r["default"],{value:parseInt(e.score),width:14}),i["default"].createElement("i",{className:"ml6 t-vt"},e.dateTime))))})):null,this.state.loading||e.length?null:i["default"].createElement("p",{className:"center"},"暂无数据"),this.state.loading?i["default"].createElement(c["default"],null):null)}});t["default"]=p,a.exports=t["default"]});