define("pagelet/appdetail/components/realrank.jsx",function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=t("react"),n=s(i),l=t("jquery"),r=s(l),c=(t("static/minxins/utils"),t("pagelet/appdetail/action/action")),d=s(c),u=t("pagelet/appdetail/store/store"),o=s(u),h=t("constants"),p=t("pagelet/compproduct/action/action"),f=s(p),m=t("pagelet/compproduct/store/store"),y=s(m),v=n["default"].createClass({displayName:"RRank",getInitialState:function(){var t=(this.props.query,this.props.filter||{});return{top1:{},top2:{},series:[],legend:{formatter:function(t){return t},orient:"vertical",data:[],top:"65%",itemWidth:50},days:t.days?t.days.value:1,country:t.country?t.country.value:h.countryCode.CHINA,payType:t.pay?t.pay.value:h.payType.FREE,device:t.device?t.device.value:h.deviceType.IPHONE}},componentDidMount:function(){var e=this;this.unSubscribe=o["default"].listen(this.onStateChange.bind(this)),this.iosUnscribe=y["default"].listen(this.onRankChange.bind(this));var a=this.props.query;t.async(["static/lib/echarts.min"],function(t){e.intChart(t)}),d["default"].ranklatest({id:a.id,country:a.country,device:a.device})},componentWillUnmount:function(){this.unSubscribe(),this.iosUnscribe()},intChart:function(t){if(this.refs.chart&&!this.chart&&t){this.chart=t.init(this.refs.chart);var e={title:{text:""},grid:{top:"5",left:"1%",height:150,right:"6%",bottom:"5%",containLabel:!0},tooltip:{},legend:this.state.legend,xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{scale:!0,splitArea:{show:!0},min:0},series:[]};this.chart.setOption(e);var a=this.props.query,s={interval:this.state.days,country:this.state.country,device:this.state.device,type:this.state.payType};1==s.interval||-1==s.interval?f["default"].getRankBy(r["default"].extend({id:a.id},s),a.title):f["default"].getCompare(r["default"].extend({appId:a.id},s),a.title)}},onStateChange:function(t){this.setState(t)},onRankChange:function(t){t.series&&(this.state.series=this.state.series.concat(t.series),this.state.legend.data=this.state.legend.data.concat(t.legend.data),this.chart.setOption({xAxis:t.xAxis,series:this.state.series,legend:this.state.legend}))},render:function(){return n["default"].createElement("div",{className:"real-rank"},n["default"].createElement("h5",{className:"title"},n["default"].createElement("i",null),"实时排名"),n["default"].createElement("table",{border:"1",cellSpacing:"0"},n["default"].createElement("tr",null,n["default"].createElement("th",{style:{width:"auto"}}),n["default"].createElement("th",null,this.state.top1.name||"-"),n["default"].createElement("th",null,this.state.top2.name||"-")),n["default"].createElement("tr",null,n["default"].createElement("td",null,"实时排名"),n["default"].createElement("td",null,n["default"].createElement("p",{className:"mt6 f16"},this.state.top1.rank),n["default"].createElement("p",{className:"f12 c999 mb6"},this.state.top1.time)),n["default"].createElement("td",null,n["default"].createElement("p",{className:"mt6 f16"},this.state.top2.rank),n["default"].createElement("p",{className:"f12 c999 mb6"},this.state.top2.time)))),n["default"].createElement("h5",{className:"title"},n["default"].createElement("p",{className:"fr f10"},h.deviceTypeStr[this.state.device],"  ",h.payTypeToStr[this.state.payType],"  ",h.countryCode2Str[this.state.country],"  ",h.days2Str[this.state.days]),n["default"].createElement("i",null),"排名趋势"),n["default"].createElement("div",{ref:"chart",style:{width:"100%",height:250}}))}});e["default"]=v,a.exports=e["default"]});