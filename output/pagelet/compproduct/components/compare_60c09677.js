define("pagelet/compproduct/components/compare.jsx",function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},n=t("react"),r=s(n),o=t("reactRouter"),l=t("jquery"),c=s(l),p=t("pagelet/widget/components/header.jsx"),d=s(p),u=t("pagelet/widget/components/loading.jsx"),h=(s(u),t("pagelet/widget/components/tabs.jsx")),y=(s(h),t("pagelet/widget/components/appItem.jsx")),f=(s(y),t("constants")),m=t("pagelet/widget/components/filter.jsx"),v=s(m),g=t("pagelet/compproduct/components/my_fav_item.jsx"),x=s(g),_=t("pagelet/compproduct/action/action"),C=s(_),E=t("pagelet/compproduct/store/store"),S=s(E),T=r["default"].createClass({displayName:"AppCompare",mixins:[o.History],getInitialState:function(){var t=this.props.location.query;return{series:[],legend:{data:[],top:"40%",itemWidth:50},app_1:t.app_1,app_2:t.app_2,days:t.days?t.days.value:1,country:t.country?t.country.value:f.countryCode.CHINA,payType:t.pay?t.pay.value:f.payType.FREE,device:t.device?t.device.value:f.deviceType.IPHONE}},componentDidMount:function(){var e=this;this.unSubscribe=S["default"].listen(this.onStateChange.bind(this)),t.async(["static/lib/echarts.min"],function(t){e.echarts=t,e.intChart(t)}),this.history.listen(function(){var t=e.props.location.query;t.filter?(e.state.legend.data=[],e.state.series=[]):e.intChart(e.echarts)})},componentWillUnmount:function(){this.unSubscribe()},intChart:function(t){if(this.refs.chart&&!this.chart&&t){this.chart=t.init(this.refs.chart);var e={title:{text:""},geo:{top:0},grid:[{x:"12%",y:"10",width:"84%",height:"30%"}],tooltip:{},legend:this.state.legend,xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{},series:[]};this.chart.setOption(e);var a={interval:this.state.days,country:this.state.country,device:this.state.device,type:this.state.payType};1==a.interval||-1==a.interval?(C["default"].getRankBy(c["default"].extend({id:this.state.app_1.id},a),this.state.app_1.title),C["default"].getRankBy(c["default"].extend({id:this.state.app_2.id},a),this.state.app_2.title)):(C["default"].getCompare(c["default"].extend({appId:this.state.app_1.id},a),this.state.app_1.title),C["default"].getCompare(c["default"].extend({appId:this.state.app_2.id},a),this.state.app_2.title))}},onStateChange:function(t){t.series&&(this.state.series=this.state.series.concat(t.series),this.state.legend.data=this.state.legend.data.concat(t.legend.data),this.chart.setOption({xAxis:t.xAxis,series:this.state.series,legend:this.state.legend}))},onFilter:function(t){var e={};t.days&&(e.days=t.days.value),t.country&&(e.country=t.country.value),t.pay&&(e.payType=t.pay.value),t.device&&(e.device=t.device.value),this.setState(e)},render:function(){var t,e=this.props.location.query;if(e.filter){this.chart&&this.chart.dispose(),this.chart=null;var a={};a.showPayMethod=a.device=a.days=a.country=!0,a.payValue={name:f.payTypeToStr[this.state.payType],value:this.state.payType},a.deviceValue={name:f.deviceTypeStr[this.state.device],value:this.state.device},a.daysValue={name:f.days2Str[this.state.days],value:this.state.days},a.countryValue={name:f.countryCode2Str[this.state.country],value:this.state.country},t=r["default"].createElement(v["default"],i({location:this.props.location,onOk:this.onFilter},a))}else t=this.renderCompare();return t},toDetail:function(t){t.id=t.id||t.appId;var e="/detail/1";this.history.pushState(null,e,t)},renderCompare:function(){this.props.location.query||{};return r["default"].createElement("div",{className:"c-page app-compare"},r["default"].createElement(d["default"],{location:this.props.location,filterEnabled:!0,showSideNav:this.props.showSideNav},"竞品对比"),r["default"].createElement("div",{className:"c-body"},r["default"].createElement("ul",{className:"clearfix rel"},r["default"].createElement(x["default"],{type:"comp",data:this.state.app_1,onClick:this.toDetail}),r["default"].createElement(x["default"],{type:"comp",data:this.state.app_2,onClick:this.toDetail}),r["default"].createElement("i",{className:"icon-vs"})),r["default"].createElement("div",{className:"content"},r["default"].createElement("h5",{className:"title"},r["default"].createElement("p",{className:"fr f10 c999"},f.deviceTypeStr[this.state.device],"  ",f.payTypeToStr[this.state.payType],"  ",f.countryCode2Str[this.state.country],"  ",f.days2Str[this.state.days]),r["default"].createElement("i",null),"排名趋势对比图")),r["default"].createElement("div",{ref:"chart",id:"cmp-chart",style:{width:"100%",height:500}})))}});e["default"]=T,a.exports=e["default"]});