define("pagelet/compproduct/components/compare.jsx",function(t,e,a){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=t("react"),n=s(i),r=t("reactRouter"),o=t("jquery"),c=s(o),l=t("pagelet/widget/components/header.jsx"),p=s(l),d=t("pagelet/widget/components/loading.jsx"),u=(s(d),t("pagelet/widget/components/tabs.jsx")),h=(s(u),t("pagelet/widget/components/appItem.jsx")),y=(s(h),t("constants")),f=t("pagelet/widget/components/filter.jsx"),m=s(f),g=t("pagelet/compproduct/components/my_fav_item.jsx"),v=s(g),x=t("pagelet/compproduct/action/action"),E=s(x),_=t("pagelet/compproduct/store/store"),C=s(_),N=n["default"].createClass({displayName:"AppCompare",mixins:[r.History],getInitialState:function(){var t=this.props.location.query;return{series:[],legend:{data:[],top:"45%",itemWidth:50},app_1:t.app_1,app_2:t.app_2,days:30,country:y.countryCode.CHINA,payType:y.payType.FREE,device:y.deviceType.IPHONE}},componentDidMount:function(){var e=this;this.unSubscribe=C["default"].listen(this.onStateChange.bind(this)),t.async(["static/lib/echarts.min"],function(t){e.echarts=t,e.intChart(t)}),this.history.listen(function(){var t=e.props.location.query;t.filter?(e.state.legend.data=[],e.state.series=[]):(console.log("filter"),e.intChart(e.echarts))})},componentWillUnmount:function(){this.unSubscribe()},intChart:function(t){if(this.refs.chart&&!this.chart&&t){this.chart=t.init(this.refs.chart);var e={title:{text:""},geo:{top:0},grid:[{x:"12%",y:"10",width:"84%",height:"30%"}],tooltip:{},legend:this.state.legend,xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{},series:[]};this.chart.setOption(e);var a={interval:this.state.days,country:this.state.country,device:this.state.device,type:this.state.payType};E["default"].getCompare(c["default"].extend({appId:this.state.app_1.id},a),this.state.app_1.title),E["default"].getCompare(c["default"].extend({appId:this.state.app_2.id},a),this.state.app_2.title)}},onStateChange:function(t){t.series&&(this.state.series=this.state.series.concat(t.series),this.state.legend.data=this.state.legend.data.concat(t.legend.data),this.chart.setOption({xAxis:t.xAxis,series:this.state.series,legend:this.state.legend}))},onFilter:function(t){var e={};t.days&&(e.days=t.days.value),t.country&&(e.country=t.country.value),t.pay&&(e.payType=t.pay.value),t.device&&(e.device=t.device.value),this.setState(e)},render:function(){var t,e=this.props.location.query;return e.filter?(this.chart&&this.chart.dispose(),this.chart=null,t=n["default"].createElement(m["default"],{onOk:this.onFilter,showPayMethod:!0,device:!0,country:!0,datetime:!0,days:!0,category:!0})):t=this.renderCompare(),t},renderCompare:function(){this.props.location.query||{};return n["default"].createElement("div",{className:"c-page app-compare"},n["default"].createElement(p["default"],{location:this.props.location,filterEnabled:!0,showSideNav:this.props.showSideNav},"竞品对比"),n["default"].createElement("div",{className:"c-body"},n["default"].createElement("ul",{className:"clearfix rel"},n["default"].createElement(v["default"],{type:"comp",data:this.state.app_1}),n["default"].createElement(v["default"],{type:"comp",data:this.state.app_2}),n["default"].createElement("i",{className:"icon-vs"})),n["default"].createElement("div",{className:"content"},n["default"].createElement("h5",{className:"title"},n["default"].createElement("p",{className:"fr f10 c999"},y.deviceTypeStr[this.state.device],"  ",y.payTypeToStr[this.state.payType],"  ",y.countryCode2Str[this.state.country],"  ",y.days2Str[this.state.days]),n["default"].createElement("i",null),"排名趋势对比图")),n["default"].createElement("div",{ref:"chart",id:"cmp-chart",style:{width:"100%",height:500}})))}});e["default"]=N,a.exports=e["default"]});