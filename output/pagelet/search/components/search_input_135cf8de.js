define("pagelet/search/components/search_input.jsx",function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var s=e("react"),n=l(s),c=e("reactRouter"),r=e("pagelet/widget/components/header.jsx"),i=l(r),u=e("pagelet/widget/components/rank.jsx"),o=l(u),d=e("pagelet/widget/components/loading.jsx"),h=l(d),f=e("pagelet/search/action/action"),m=l(f),p=e("pagelet/search/store/store"),E=l(p),y=n["default"].createClass({displayName:"SearchItem",mixins:[c.History],toDetail:function(){var e=Object.assign({},this.props.data);this.history.pushState("","detail/1",e)},render:function(){var e=parseFloat(this.props.data.score||0);return n["default"].createElement("li",{className:"app-item",onClick:this.toDetail},n["default"].createElement("table",null,n["default"].createElement("tr",null,n["default"].createElement("td",null,n["default"].createElement("img",{className:"app-icon",src:this.props.data.icon})),n["default"].createElement("td",null,n["default"].createElement("p",{className:"title ellipsis"},this.props.index+1,"、",this.props.data.title),n["default"].createElement("p",{className:"f12 c666 m5 mb5"},this.props.data.developer),n["default"].createElement("div",null,n["default"].createElement("span",{className:"t-vt c666 f12 mr5"},"应用"),n["default"].createElement(o["default"],{value:e,width:14}),n["default"].createElement("span",{className:"c666 f12 ml5 t-vt"},this.props.data.score))))))}}),g=n["default"].createClass({displayName:"Search",mixins:[c.History],getInitialState:function(){return{searchKey:null,deviceType:"iphone",searchResultList:[],page:1,total:0}},componentDidMount:function(){this.unSubscribe=E["default"].listen(this.onStateChange.bind(this))},componentWillUnmount:function(){this.unSubscribe()},onStateChange:function(e){e.searchResultList&&(e.searchResultList=this.state.searchResultList.concat(e.searchResultList)),this.setState(e)},onTagSelected:function(e){this.setState({searchKey:e}),m["default"].search(e,1)},onChooseDevice:function(e){this.setState({deviceType:e})},onSearch:function(e){this.setState({searchKey:e}),m["default"].search(e,1)},handleScroll:function(e){var t=e.target;console.log(123213),t.offsetHeight+t.scrollTop+10>=t.scrollHeight&&!this.state.loading&&this.state.searchResultList.length<this.state.total&&this.loadMore()},loadMore:function(){var e=this.state.page+1;this.setState({page:e}),m["default"].search(this.state.searchKey,e)},render:function(){var e=this,t=["微信","去哪儿旅行","爱奇艺","神州租车","贵催等全集","微信","去哪儿旅行","爱奇艺","神州租车","贵催等全集"],a=t,l=this.state,s=l.deviceType,c=l.searchResultList;return n["default"].createElement("div",{className:"c-page input-search"},n["default"].createElement(i["default"],{searchValue:this.state.searchKey,onSearch:this.onSearch,onCancelSearch:function(){return e.history.goBack()},type:"search"}),n["default"].createElement("div",{className:"default-view",style:{display:this.state.searchKey?"none":"block"}},n["default"].createElement("label",null,"热门应用"),n["default"].createElement("div",{className:"tags hot-app"},t.map(function(t,a){return n["default"].createElement("span",{key:a,onClick:function(){return e.onTagSelected(t)}},t)})),n["default"].createElement("label",null,"历史搜索"),n["default"].createElement("div",{className:"tags history"},a.map(function(t,a){return n["default"].createElement("span",{key:a,onClick:function(){return e.onTagSelected(t)}},t)}))),n["default"].createElement("div",{onScroll:this.handleScroll.bind(this),className:"search-result c-body",style:{display:this.state.searchKey?"block":"none"}},n["default"].createElement("ul",{className:"device-type clearfix"},n["default"].createElement("li",{onClick:function(){return e.onChooseDevice("iphone")},className:"fl "+("iphone"==s?"cur":"")},"iPhone"),n["default"].createElement("li",{onClick:function(){return e.onChooseDevice("ipad")},className:"fl "+("ipad"==s?"cur":"")},"iPad")),n["default"].createElement("p",{className:"center c999 f12"},this.state.searchKey,", ",this.state.total,"条结果 ",(new Date).format("yyyy-MM-dd hh:mm:ss")),n["default"].createElement("div",{className:"keyword-desc"},n["default"].createElement("table",{border:"1",cellSpacing:"0"},n["default"].createElement("tr",null,n["default"].createElement("th",null,"关键字"),n["default"].createElement("th",null,"搜索热度"),n["default"].createElement("th",null,"搜索结果数")),n["default"].createElement("tr",null,n["default"].createElement("td",null,this.state.searchKey),n["default"].createElement("td",null,"123213"),n["default"].createElement("td",null,this.state.total)))),n["default"].createElement("ul",null,c.map(function(e,t){return n["default"].createElement(y,{key:t,data:e,index:t})}),this.state.loading?n["default"].createElement(h["default"],null):null)))}});t["default"]=g,a.exports=t["default"]});